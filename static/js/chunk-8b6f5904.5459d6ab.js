(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8b6f5904"],{2423:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a("b775");function l(e){return Object(n["a"])({url:"/article/list",method:"get",params:e})}},"5fb3":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",[a("FilenameOption",{model:{value:e.filename,callback:function(t){e.filename=t},expression:"filename"}}),a("AutoWidthOption",{model:{value:e.autoWidth,callback:function(t){e.autoWidth=t},expression:"autoWidth"}}),a("BookTypeOption",{model:{value:e.bookType,callback:function(t){e.bookType=t},expression:"bookType"}}),a("el-button",{staticStyle:{margin:"0 0 20px 20px"},attrs:{loading:e.downloadLoading,type:"primary",icon:"el-icon-document"},on:{click:e.handleDownload}},[e._v(" Export Excel ")]),a("el-button",{staticStyle:{"margin-bottom":"20px"},attrs:{loading:e.downloadLoading2,type:"primary",icon:"el-icon-document"},on:{click:e.handleDownload2}},[e._v("导出图片和数据到Excel")]),a("a",{staticStyle:{"margin-left":"15px"},attrs:{href:"https://panjiachen.github.io/vue-element-admin-site/feature/component/excel.html",target:"_blank"}},[a("el-tag",{attrs:{type:"info"}},[e._v("Documentation")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list,"element-loading-text":"Loading...",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",label:"Id",width:"95"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.$index)+" ")]}}])}),a("el-table-column",{attrs:{label:"Title"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.title)+" ")]}}])}),a("el-table-column",{attrs:{label:"Author",width:"110",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",[e._v(e._s(t.row.author))])]}}])}),a("el-table-column",{attrs:{label:"Readings",width:"115",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.pageviews)+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:"Date",width:"220"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("i",{staticClass:"el-icon-time"}),a("span",[e._v(e._s(e._f("parseTime")(t.row.timestamp,"{y}-{m}-{d} {h}:{i}")))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"Image",width:"220"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("el-image",{staticStyle:{height:"40px"},attrs:{src:e.row.image_uri}})]}}])})],1)],1)},l=[],i=a("c7eb"),o=a("1da1"),r=a("5530"),s=(a("ddb0"),a("d81d"),a("2f62")),c=a("2423"),u=a("ed08");a("c975"),a("caad"),a("13d5"),a("4de4"),a("2532"),a("14d9");function d(e){return!!e.prop&&!["selection","index","expand"].includes(e.table_type)}function p(){return b.apply(this,arguments)}function b(){return b=Object(o["a"])(Object(i["a"])().mark((function e(t=[],a=[],n,l=[]){var o,r,s,c,p,b,h,f,m,g,x,k,v,_,y,w,O,j,S;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(console.time("excel_data_format"),o=l.length>0?t.filter(e=>l.includes(e.prop)):t.filter(e=>d(e)),r=[],s={},c=[],p={},b=0;b<o.length;b++)h=o[b],f=h.prop,m=h.formatOptions,h["options"]=m?m(n,h.options):h.options||n[f],s[f]=h,r.push(h.label);b=0;case 8:if(!(b<a.length)){e.next=37;break}g=a[b],x=[],k=0;case 12:if(!(k<o.length)){e.next=33;break}if(v=o[k].prop,_=s[v],f=_.prop,y=_.options,w=_.formatValue,!y&&!w){e.next=29;break}if(O=g[f],j=`${f}-${O}`,S=p[j],S){e.next=26;break}if(!w){e.next=24;break}return e.next=23,w(s[v],O,n);case 23:p[j]=e.sent;case 24:y&&(p[j]=Object(u["h"])(O,y)),S=p[j];case 26:x.push(S),e.next=30;break;case 29:x.push(g[f]);case 30:k++,e.next=12;break;case 33:c.push(x);case 34:b++,e.next=8;break;case 37:return console.timeEnd("excel_data_format"),e.abrupt("return",{data:c,header:r});case 39:case"end":return e.stop()}}),e)}))),b.apply(this,arguments)}var h=a("2d5d"),f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{display:"inline-block"}},[a("label",{staticClass:"radio-label",staticStyle:{"padding-left":"0"}},[e._v("Filename: ")]),a("el-input",{staticStyle:{width:"345px"},attrs:{placeholder:"Please enter the file name (default excel-list)","prefix-icon":"el-icon-document"},model:{value:e.filename,callback:function(t){e.filename=t},expression:"filename"}})],1)},m=[],g={props:{value:{type:String,default:""}},computed:{filename:{get(){return this.value},set(e){this.$emit("input",e)}}}},x=g,k=a("2877"),v=Object(k["a"])(x,f,m,!1,null,null,null),_=v.exports,y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{display:"inline-block"}},[a("label",{staticClass:"radio-label"},[e._v("Cell Auto-Width: ")]),a("el-radio-group",{model:{value:e.autoWidth,callback:function(t){e.autoWidth=t},expression:"autoWidth"}},[a("el-radio",{attrs:{label:!0,border:""}},[e._v(" True ")]),a("el-radio",{attrs:{label:!1,border:""}},[e._v(" False ")])],1)],1)},w=[],O={props:{value:{type:Boolean,default:!0}},computed:{autoWidth:{get(){return this.value},set(e){this.$emit("input",e)}}}},j=O,S=Object(k["a"])(j,y,w,!1,null,null,null),T=S.exports,L=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{display:"inline-block"}},[a("label",{staticClass:"radio-label"},[e._v("Book Type: ")]),a("el-select",{staticStyle:{width:"120px"},model:{value:e.bookType,callback:function(t){e.bookType=t},expression:"bookType"}},e._l(e.options,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)},W=[],D={props:{value:{type:String,default:"xlsx"}},data(){return{options:["xlsx","csv","txt"]}},computed:{bookType:{get(){return this.value},set(e){this.$emit("input",e)}}}},E=D,$=Object(k["a"])(E,L,W,!1,null,null,null),A=$.exports,C={name:"ExportExcel",components:{FilenameOption:_,AutoWidthOption:T,BookTypeOption:A},data(){return{list:null,listLoading:!0,downloadLoading:!1,downloadLoading2:!1,filename:"",autoWidth:!0,bookType:"xlsx"}},computed:Object(r["a"])({},Object(s["b"])(["allOptions"])),created(){this.fetchData()},methods:{fetchData(){this.listLoading=!0,Object(c["a"])().then(e=>{this.list=e.data.items,this.listLoading=!1}).catch(()=>{this.listLoading=!1})},handleDownload(){this.downloadLoading=!0,Promise.all([a.e("chunk-485da91a"),a.e("chunk-10b3b964"),a.e("chunk-2133cd4f")]).then(a.bind(null,"4bf8")).then(e=>{const t=["Id","Title","Author","Readings","Date","Image"],a=["id","title","author","pageviews","display_time","image_uri"],n=this.list,l=this.formatJson(a,n);e.export_json_to_excel({header:t,data:l,filename:this.filename,autoWidth:this.autoWidth,bookType:this.bookType}),this.downloadLoading=!1})},handleDownload2(){var e=this;return Object(o["a"])(Object(i["a"])().mark((function t(){var n,l,r,s,c,u,d;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=[{label:"Title",prop:"title"},{label:"Author",prop:"author"},{label:"Readings",prop:"pageviews"},{label:"Date",prop:"display_time"},{label:"Image",prop:"image_uri",formatValue:function(){var e=Object(o["a"])(Object(i["a"])().mark((function e(t,a){return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!a){e.next=6;break}return e.next=3,Object(h["c"])(a).then(h["b"]);case 3:e.t0=e.sent,e.next=7;break;case 6:e.t0="";case 7:return e.abrupt("return",e.t0);case 8:case"end":return e.stop()}}),e)})));function t(t,a){return e.apply(this,arguments)}return t}()}],l=e.list,r=e.allOptions,t.prev=2,e.downloadLoading2=!0,t.next=6,Promise.all([a.e("chunk-485da91a"),a.e("chunk-10b3b964"),a.e("chunk-2133cd4f")]).then(a.bind(null,"4bf8"));case 6:return s=t.sent,console.log(s),t.next=10,p(n,l,r);case 10:c=t.sent,u=c.header,d=c.data,s.export_table_to_excel2(u,d,"下载"),e.downloadLoading2=!1,t.next=20;break;case 17:t.prev=17,t.t0=t["catch"](2),e.downloadLoading2=!1;case 20:case"end":return t.stop()}}),t,null,[[2,17]])})))()},formatJson(e,t){return t.map(t=>e.map(e=>"timestamp"===e?Object(u["k"])(t[e]):t[e]))}}},I=C,B=(a("af6f"),Object(k["a"])(I,n,l,!1,null,null,null));t["default"]=B.exports},9315:function(e,t,a){},af6f:function(e,t,a){"use strict";a("9315")}}]);